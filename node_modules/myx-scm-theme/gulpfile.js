/**
 * Created by vijayakrishna.kudva on 09/07/15.
 */
'use strict';

var gulp = require('gulp');
var sass = require('gulp-sass');
var concat = require('gulp-concat');
var sourcemaps = require('gulp-sourcemaps');
var listOfFiles = require('./theme/theme.js');
var uglify = require('gulp-uglify');
var minify = require('gulp-minify-css');

gulp.task('sass', function () {
    //gulp.src('theme/sass/**/*.scss') // compile all individual scss files.
    //    .pipe(sourcemaps.init())
    //    .pipe(sass())
    //    .pipe(sourcemaps.write())
    //    .pipe(gulp.dest('./.css'));// /assets related

    gulp.src('./theme/theme.scss')// compile only the references mentioned in index.scss
        .pipe(sourcemaps.init())
        .pipe(sass().on('error', sass.logError))
        .pipe(concat('theme.min.css'))
        //.pipe(minify({compatibility: 'ie10'}).on('error',function(er){console.log(er)}))
        .pipe(sourcemaps.write())
        .pipe(gulp.dest('dist/'));// /assets related
});

gulp.task('uglify', function() {
    gulp.src(listOfFiles)
        .pipe(uglify().on('error',function(er){console.log(er)}))
        .pipe(concat('theme.min.js'))
        .pipe(gulp.dest('dist/'));
});

gulp.task('fonts', function() {
    gulp.src(['./theme/assets/global/plugins/simple-line-icons/fonts/**/*','./theme/assets/global/plugins/font-awesome/fonts/**/*'])
        .pipe(gulp.dest('dist/fonts'));
});

gulp.task('html', function() {
    gulp.src('./theme/theme.html')
        .pipe(gulp.dest('dist/'));
});

gulp.task('build', ['sass','uglify','fonts','html'], function () {
});